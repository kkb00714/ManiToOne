<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="user-nickname" th:content="${post.user.nickname}" />
    <link rel="stylesheet" th:href="@{/style/reset.css}" />
    <link rel="stylesheet" th:href="@{/style/common.css}" />
    <link rel="stylesheet" th:href="@{/style/post.css}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/x-icon"
      th:href="@{/images/favicon/favicon.ico}"
    />
    <title>ManiToOne</title>
  </head>
  <body>
    <header th:replace="~{fragments/common/header :: header}"></header>
    <main class="main-container">
      <section class="middle-section" id="middleSection">
        <!-- 게시글 -->
        <section class="timeline-section">
          <div class="timeline">
            <div class="post-container">
              <img
                class="user-photo"
                th:src="@{${post.user.profileImage}}"
                alt="user icon"
              />
              <div class="post-content">
                <div class="user-info">
                  <span
                    class="user-name"
                    th:text="${post.user.nickname}"
                  ></span>
                  <span
                    class="passed-time"
                    th:text="${post.updatedAt != null ? #strings.concat(#temporals.format(post.updatedAt, 'mm'), '분') : #strings.concat(#temporals.format(post.createdAt, 'mm'), '분')}"
                  ></span>
                </div>
                <p class="content-text" th:text="${post.content}"></p>
                <img
                  class="post-image"
                  th:src="@{/images/image-beer.webp}"
                  alt="beer image"
                />
                <p
                  class="post-time"
                  th:text="${post.updatedAt != null ? #temporals.format(post.updatedAt, 'yyyy년 MM월 dd일 a hh시 mm분') : #temporals.format(post.createdAt, 'yyyy년 MM월 dd일 a hh시 mm분')}"
                ></p>
                <div class="reaction-icons">
                  <img
                    class="tiny-icons"
                    th:src="@{/images/icons/icon-clover2.png}"
                    alt="I like this"
                    th:onclick="'likePost(' + ${post.postId} + ')'"
                  />
                  <span class="like-count" th:text="${post.likesNumber}"></span>
                  <img
                    class="tiny-icons"
                    th:src="@{/images/icons/icon-comment2.png}"
                    alt="add reply"
                  />
                  <span class="reply-count" th:text="${postRepliesNum}"></span>
                </div>
              </div>
              <div class="option-icons">
                <img
                  class="tiny-icons"
                  th:src="@{/images/icons/UI-more2.png}"
                  alt="more options"
                />
                <img
                  class="tiny-icons"
                  th:src="@{/images/icons/icon-add-friend.png}"
                  alt="add friend"
                />
              </div>
            </div>

            <div id="reply-divider">
              <p id="reply-divider-text">답글</p>
            </div>

            <!-- 답글 -->
            <div class="post-container" th:each="reply : ${replies}">
              <img
                class="user-photo"
                th:src="@{${reply.user.profileImage}}"
                alt="user icon"
              />
              <div class="post-content">
                <div class="user-info">
                  <span
                    class="user-name"
                    th:text="${reply.user.nickname}"
                  ></span>
                  <span
                    class="passed-time"
                    th:text="${#temporals.format(reply.createdAt, 'mm분')}"
                  ></span>
                </div>
                <p
                  class="content-text"
                  th:text="${reply.content}"
                  th:onclick="'directToReply(' + ${reply.replyPostId} + ')'"
                ></p>
                <div class="reaction-icons">
                  <img
                    class="tiny-icons"
                    th:src="@{/images/icons/icon-clover2.png}"
                    alt="I like this"
                    th:onclick="'likeReply(' + ${reply.replyPostId} + ')'"
                  />
                  <span
                    class="like-count"
                    th:text="${reply.likesNumber}"
                  ></span>
                  <img
                    class="tiny-icons"
                    th:src="@{/images/icons/icon-comment2.png}"
                    alt="add reply"
                  />
                  <span
                    class="reply-count"
                    th:text="${reply.rerepliesNumber}"
                  ></span>
                </div>
              </div>
              <div class="option-icons">
                <img
                  class="tiny-icons"
                  th:src="@{/images/icons/UI-more2.png}"
                  alt="more options"
                />
                <img
                  class="tiny-icons"
                  th:src="@{/images/icons/icon-add-friend.png}"
                  alt="add friend"
                />
              </div>
            </div>
          </div>
        </section>
      </section>
      <article
        th:replace="~{fragments/common/right-section :: right-section}"
      ></article>
    </main>
    <script th:src="@{/script/common.js}"></script>
    <script th:src="@{/script/post.js}"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
